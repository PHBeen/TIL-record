# TIL Template
날짜: 2025-11-15

## 스크럼
- 학습 목표 1 : GAN 모델 직접 구현하기
- 학습 목표 2 : 오버피팅을 데이터로 해결하기
- 학습 목표 3 : 블로그 글 작성하기


## 새로 배운 내용
### 주제 1: GAN 모델 직접 구현하기.
- **GAN을 직접 구현하기** : StyleGAN2를 활용하여 이미지 생성하기. -> PyTorch로 생성이 어려움을 확인. 
- **GAN을 활용하여 학습데이터를 구축할 수 있는지 확인**: GAN은 가짜 데이터이기에, 학습데이터로 활용하기 적절하지 않음을 확인했다. GAN 모델 사용할 때의 문제정의가 달랐기에 해당 실험에서 원하는 퀄리티의 데이터를 얻는데에 실패함. 데이터 불균형 문제를 해결하기 위해선 GAN을 통해 가짜 데이터를 생성하는 것이 아닌, crop, flip등의 데이터 augmentation을 통해 해결해야한다.

### 주제 2: 오버피팅을 데이터로 해결하기
- **Data Augmentation을 통한 데이터 불균형 문제 해결하기** : 데이터 불균형 문제를 클래스 밸런싱을 통해 해결하였으나, 여전히 overfitting을 보임.

| 클래스 밸런싱 전 | 클래스 밸런싱 후 |
| -- | -- |
| <img width="400" height="270" alt="image" src="https://github.com/user-attachments/assets/bd623856-de02-48b5-8e10-1efb3632d154" /> | <img width="400" height="270" alt="image" src="https://github.com/user-attachments/assets/74ac8487-3c09-4d00-8522-298900863f90" />|
|<img width="400" height="220" alt="image" src="https://github.com/user-attachments/assets/b308da29-b3dc-4771-9187-0b278d22cf4d" /> | <img width="400" height="220" alt="image" src="https://github.com/user-attachments/assets/c3516c72-6712-4be1-9f3e-609aa199de75" /> |

-  **Data-level Regularization을 통한 overfitting 해결하기(스크레치 학습)**: Strong Augmentation + Regularization-by-Mixing + Anti-overfitting Augmentation + Class Balancing을 사용하여 pretrained모델 없이 오버피팅 제어. -> 오버피팅이 제어됨.

| Data-level Regularization 전(epochs = 5) | Data-level Regularization 후(epochs = 19) |
| -- | -- |
| <img width="400" height="220" alt="image" src="https://github.com/user-attachments/assets/c3516c72-6712-4be1-9f3e-609aa199de75" /> | <img width="400" height="220" alt="image" src="https://github.com/user-attachments/assets/f522f375-7c30-492f-bae0-798ee80db5e0" /> |

- **pretrained-Model을 통한 Overfitting 제어 + accuracy 높이기**: Strong Augmentation + Regularization-by-Mixing + Anti-overfitting Augmentation + Class Balancing + Pretrained-model을 사용하여 더 오버피팅이 제어되며, 더 정확한 성능을 내는 모델로 학습시킨다.

| Pretrained = False (epochs = 19) | Pretrained = True (epochs = 7) |
| -- | -- |
| <img width="400" height="220" alt="image" src="https://github.com/user-attachments/assets/f522f375-7c30-492f-bae0-798ee80db5e0" /> | <img width="400" height="220" alt="image" src="https://github.com/user-attachments/assets/f247666f-971e-4de7-baeb-3f6015d83067" /> |

### 주제 3: 
- **상세 내용 1** : 
- **상세 내용 2** : 


## 오늘의 도전 과제와 해결 방법
- **StyleGAN을 통한 데이터 생성 완료하기**: GAN은 데이터를 새롭게 생성하는 모델이며, 가짜 데이터이기 때문에 학습에 사용할 데이터로 생성하는 것은 옳지 않다.
- **데이터를 수정하여 오버피팅을 제어하고, 학습률을 높이기**: Data-augmentation, Data-level Regularization, Pretrained 모델을 한단계씩 추가하여 train loss, acc, F1 score등을 비교하여 성능을 평가한다. 


## 오늘의 회고
- StyleGAN2로 학습에 사용할 데이터를 생성하기엔 한계가 있다. GAN모델은 기존에 없었던 새로운 이미지를 생성하는 테스크에 활용하는 것이 적합하다.
- 오버피팅은 데이터를 통해 제어할 수 있었다. 오버피팅을 제어하면서 **정확도 97%까지** 도달할 수 있었다.

<Classification Report (Pretrained ResNet-18)>

1. Class-wise Performance

| Class       | Precision | Recall | F1-Score | Support |
|-------------|-----------|--------|----------|---------|
| butterfly   | **0.98** | 0.97 | 0.97 | 427 |
| cat         | **0.97** | 0.94 | 0.96 | 390 |
| chicken     | **0.97** | 0.98 | 0.97 | 391 |
| cow         | **0.96** | 0.94 | 0.95 | 389 |
| dog         | **0.92** | 0.96 | 0.94 | 398 |
| elephant    | **0.98** | 0.98 | 0.98 | 386 |
| horse       | **0.98** | 0.96 | 0.97 | 380 |
| sheep       | **0.96** | 0.96 | 0.96 | 423 |
| spider      | **0.96** | 0.99 | 0.98 | 405 |
| squirrel    | **0.97** | 0.98 | 0.97 | 411 |

2. Overall Performance

| Metric        | Score | Samples |
|---------------|--------|----------|
| **Accuracy**        | **0.97** | 4000 |
| **Macro Avg (F1)**  | 0.97 | 4000 |
| **Weighted Avg (F1)** | 0.97 | 4000 |



## 참고 자료 및 링크

- 
