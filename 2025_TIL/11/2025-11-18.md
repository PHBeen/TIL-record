# TIL Template
날짜: 2025-11-18

## 스크럼
- 학습 목표 1 : 오버피팅이 발생된 모델 계층 출력 및 원인 파악하기.
- 학습 목표 2 : 블로그 글 작성하기(오버피팅 -> 모델 중심 관점으로 설명하기)


## 새로 배운 내용
### 주제 1: 오버피팅이 발생된 모델 계층 출력 및 원인 파악하기. 
- **경량모델로 재학습**: ResNet-18(11M)에서 MobileNetV2(3.4M), ResNet-10(5~6M)로 모델의 복잡도를 낮추어 학습 후 오버피팅 추세를 확인하기. - **ResNet-10의 모델 복잡도가 가장 적합함**

| ResNet-18(11M) - 오버피팅 | MobileNetV2(3.4M) - 언더피팅 | ResNet-10(5~6M) - Sweet-spot
| -- | -- | -- |
| <img width="400" height="300" alt="image" src="https://github.com/user-attachments/assets/9defc91c-cec4-41bf-84ed-d5cf33d0771e" /> | <img width="400" height="300" alt="image" src="https://github.com/user-attachments/assets/951e1b44-8f14-4cdc-81ea-106ab815ca7d" /> | <img width="400" height="300" alt="image" src="https://github.com/user-attachments/assets/d686da3d-3cda-4d3b-afce-ce648c726501" /> |

- **Grad-CAM을 통해 오버피팅 이해하기** : Grad-CAM을 통해, 모델이 어떤점을 특징적으로 생각하는지 시각화함.

| ResNet-18(11M) - 오버피팅 | MobileNetV2(3.4M) - 언더피팅 | ResNet-10(5~6M) - Sweet-spot
| -- | -- | -- |
| 상대적으로 덜 중요한 특징(포즈, 질감)을 잡음. | 중요한 특징(얼굴, 귀, 질감)을 아예 잡지 못함 | 이미지 전반적으로 파악하여 중요한 특징을 잡음 |
| <img width="400" height="400" alt="gradcam_res18_cat" src="https://github.com/user-attachments/assets/819735fa-7b88-4377-a604-136b9e79d6fb" /> | <img width="400" height="400" alt="gradcam_mobile_cat" src="https://github.com/user-attachments/assets/466929e3-78fb-4181-a97a-87419d297207" /> | <img width="400" height="400" alt="gradcam_res10_cat" src="https://github.com/user-attachments/assets/2a7fafc0-56bf-4620-8f12-5664b2d9f7d7" /> |

### 주제 2: 블로그 글 작성하기(오버피팅 -> 모델 중심 관점으로 설명하기)
- **Grad-CAM 원리 이해하기** :  Grad-cam은 CNN-based 모델에서 conv층 마지막 featuremap의 미분값을 계산하고, interpolation을 통해 입력 이미지에서 모델이 중요하게 본 부위를 시각적으로 표현하는 방법이다.

1. receptive Area: 마지막 conv층의 feature map 픽셀 하나가 대응되는 원본 이미지의 픽셀 범위(receptive area가 131이라면, 마지막 conv층의 feature map (1,1)은 입력이미지 [0:131, 0:131]에 영향을 받은 것이다.)
2. hook: Grad-CAM을 그리기 위해 forward, backward값을 계산하는 함수.

- 글 작성 시작함.


## 오늘의 도전 과제와 해결 방법
- 모델 중심 관점에서 오버피팅 제어가 가능할지 실험한다: 어느정도 제어는 가능하지만, 근본적인 해결이 되지 않았다. 
- Grad-CAM의 원리 이해하고 Grad-CAM을 통해 오버피팅을 설명하기: 오버피팅이 된 모델은 너무 국소적인 부위를 집중하는 경향이 있다. 오히려 넓은 범위를 집중하는 resnet-10모델이 일반화 성능이 좋다고 할 수 있다.  


## 오늘의 회고
- 이후 오버피팅 발생시, 데이터의 복잡도와 모델의 복잡도를 고려하여 복잡도가 비슷하도록 설계해야함을 알 수 있었다. 
- 마지막 conv층이 가지는 의미를 통해 모델을 해석하는 XAI를 진행할 수 있었다.

## 참고 자료 및 링크
- [Grad-CAM 논문](https://arxiv.org/abs/1610.02391)